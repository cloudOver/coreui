<div ng-controller="CoreCtrl">
    <div class="row">
        <div class="col-md-12 panel">
            <div class="panel-heading">Virtual machines</div>
            <div class="panel-body">
                <table class="table table-stripped" ng-table="vmsTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Description</th>
                            <th>State</th>
                            <th>Template</th>
                            <th>Base image</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="vm in vms" ng-click="edit(vm)">
                            <td>{{ vm.id }}</td>
                            <td data-title="'Name'" sortable="'name'">{{ vm.name }}</td>
                            <td>{{ vm.description }}</td>
                            <td data-title="'State'" sortable="'state'">{{ vm.state }}</td>
                            <td data-title="'Template'" sortable="'template'">{{ vm.template.name }}</td>
                            <td data-title="'Base image'" sortable="'base_image'">{{ vm.base_image.name }}</td>
                            <td><button ng-click="edit(vm)">Edit</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    function viewController($scope) {
        $scope.edit = function(vm) {
            alert(vm.id);
        };
        request('/api/vm/get_list/', {token: $.cookie("core_token")}, function(vms) {
            $scope.vms = vms;
            $scope.$apply();
        });
    }
</script>