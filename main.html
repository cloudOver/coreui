<div class="row">
    <div class="col-md-6">
        <div class="well well-sm" id="running_instances"></div>
        <div class="well well-sm" id="capabilities"></div>
    </div>
    <div class="col-md-6">
        <label for="quota_storage">Storage: </label>
        <div class="progress">
            <div id="quota_storage" class="progress-bar progress-bar-warning progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="10" style="width: 0%;"></div>
        </div>
        <label for="quota_cpu">CPU: </label>
        <div class="progress">
            <div id="quota_cpu" class="progress-bar progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>
        </div>
        <label for="quota_memory">Memory: </label>
        <div class="progress">
            <div id="quota_memory" class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>
        </div>
    </div>
</div>


<script type="text/javascript">
    request('/api/vm/get_list/', {token: window.token}, function(r) {
        $("#running_instances").empty();
        if (r.length == 0)
            $("#running_instances").append('You have no running instances');
        else if (r.length == 1)
            $("#running_instances").append('You have <b>one</b> running instance<br />');
        else
            $("#running_instances").append('You have <b>' + r.length + '</b> running instances<br />');
    });

    request('/user/user/get_info/', {login: window.login, pw_hash: window.pw_hash}, function(r) {
        $("#quota_storage").animate({width: r['storage_used']/r['storage_quota']*100 + '%'});
        $('#quota_storage').empty().append(parseFloat(r['storage_used']/1024/1024/1024).toPrecision(2) + ' of ' + parseFloat(r['storage_quota']/1024/1024/1024).toPrecision(2) + ' GB');

        $("#quota_memory").animate({width: r['memory_used']/r['memory_quota']*100 + '%'});
        $('#quota_memory').empty().append(r['memory_used'] + ' of ' + r['memory_quota'] + ' MB');

        $("#quota_cpu").animate({width: r['cpu_used']/r['cpu_quota']*100 + '%'});
        $('#quota_cpu').empty().append(r['cpu_used'] + ' of ' + r['cpu_quota'] + ' Cores');
    });

    request('/api/template/capabilities/', {token: window.token}, function(caps) {
        request('/api/template/get_list/', {token: window.token}, function(templ) {
            $("#capabilities").empty();
            $("#capabilities").append('<b>Available resources</b> (templates):<br/>');
            for (i = 0; i < templ.length; i++) {
                $("#capabilities").append(templ[i]['name'] + ": <b>" + caps[templ[i]["id"]] + "</b><br/>");
            }
        });
    });
    request('/api/template/capabilities/', {token: window.token}, function(caps) {
        $("#capabilities").append("<b>Available storage: </b>" + caps/1024 + " GB");
    });
</script>