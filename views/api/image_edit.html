<!--
Copyright (c) 2014-2016 cloudover.io ltd.

This file is part of CloudOver project.

cloudover.coreCluster is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.

-->


<div class="ui container">
    <div class="ui segment">
        <div class="ui three column grid">
            <div class="column">
                <div class="ui icon header">
                    <i class="disk outline icon"></i>
                    {{ image.name }}
                </div>
            </div>
            <div class="column">
                <div class="meta">ID: {{ image.id }}</div>
                <div class="meta">Size: {{ image.size }}</div>
                <div class="meta">State:
                    <i ng-show="image.state == 'init'" class="blue settings icon"></i>
                    <i ng-show="image.state == 'failed'" class="red remove icon"></i>
                    <i ng-show="image.state == 'in progress'" class="green cloud upload icon"></i>
                    <i ng-show="image.state == 'ok'" class="green checkmark icon"></i>
                    {{ image.state }}
                </div>
                <div class="divider"></div>
                <div class="meta">Created: {{ image.creation_date }}</div>
                <div class="meta">Format: {{ image.format }}</div>
            </div>
            <div class="right aligned column">
                <button class="ui red image button" ng-click="imageRemove()"><i class="remove icon"></i> Remove</button>
            </div>
        </div>
    </div>
    <div class="ui styled fluid accordion">
        <div class="title active">
            <i class="dropdown icon"></i>
            Basic information
        </div>
        <div class="content active">
            <p style="display: block ! important;" class="transition visible">
                <div class="ui two column grid">
                    <div class="ui column form">
                        <div class="field">
                            <div class="ui left icon input">
                                <i class="edit icon"></i>
                                <input type="text" ng-model="image.name" placeholder="Image name">
                            </div>
                        </div>
                        <div class="field">
                            <div class="ui left icon input">
                                <i class="edit icon"></i>
                                <textarea rows=4 ng-model="image.description" placeholder="Description"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="ui column">
                        <div class="ui header" ng-show="image.attached_to_id">
                            Attached as external drive to instance {{ image.attached_to }}
                            <button class="ui red button" ng-click="imageDetach(image.attached_to_id, image.id)">Detach</button>
                        </div>
                        <div class="ui header">Tasks</div>
                        <div class="content" id="tasks">
                            <table class="ui table">
                                <thead>
                                    <th>Type</th>
                                    <th>Action</th>
                                    <th>State</th>
                                </thead>
                                <tr data-ng-repeat="task in image.tasks" ng-class="{danger: task.state=='failed', success: task.state=='in progress', warning: task.state=='waiting'}">
                                    <td>{{task.type}}</td>
                                    <td>{{task.action}}</td>
                                    <td ng-show="task.action != 'upload_url'">{{task.state}}</td>
                                    <td ng-show="task.action == 'upload_url'">
                                        <div class="progress">
                                            <div class="progress-bar" role="progressbar" aria-valuenow="44" aria-valuemin="0" aria-valuemax="100" ng-attr-style="width: {{image.data.progress*100}}%">
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                            <div id="task_graph" style="height: 100%; border: 1px #4f4f4f solid; width: 100%;"></div>
                        </div>
                    </div>
                </div>
            </p>
        </div>

        <div class="title active">
            <i class="dropdown icon"></i>
            Advanced
        </div>
        <div class="content">
            <p style="display: block ! important;" class="transition visible">
                <div class="ui two column grid">
                    <div class="ui column form">
                        <div class="field">
                            <label>Access: </label>
                            <div class="ui input">
                                <select class="ui search dropdown" ng-model="image.access" id="access">
                                    <option value="private" selected>Private</option>
                                    <option value="group">Group</option>
                                    <option value="public">Public</option>
                                </select>
                            </div>
                        </div>
                        <div class="field">
                            <label>Type: </label>
                            <div class="ui input">
                                <select class="ui search dropdown" ng-model="image.type" required id="type" ng-options="type for type in types"></select>
                            </div>
                        </div>
                    </div>
                    <div class="ui column form">
                        <div class="field">
                            <label>Network card: </label>
                            <div class="ui input">
                                <select class="ui search dropdown" ng-model="image.network_device" required ng-options="network_device for network_device in network_devices" id="network_device"></select>
                            </div>
                        </div>
                        <div class="field">
                            <label>Disk controller: </label>
                            <div class="ui input">
                                <select class="ui search dropdown" ng-model="image.disk_controller" required id="disk_controller" ng-options="disk_controller for disk_controller in disk_controllers"></select>
                            </div>
                        </div>
                        <div class="field">
                            <label>Emulated graphics card: </label>
                            <div class="ui input">
                                <select class="ui search dropdown" ng-model="image.video_device" required ng-options="video_device for video_device in video_devices" id="video_device"></select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $('.ui.checkbox').checkbox();
    $('select.dropdown').dropdown();
    $('.ui.accordion').accordion();
</script>
    <a href="#/api/image/">Go back to image list</a>
    &nbsp;&nbsp;&nbsp;
    <button type="submit" ng-click="imageSave()" class="btn btn-lg btn-success">Save changes</button>
</div>

